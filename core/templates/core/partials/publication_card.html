{% load static %}
<div id="pub-{{ pub.pk }}" class="publication-card rounded-2xl p-6 mb-6 bg-[#101624] border border-blue-400/30 shadow-xl group relative transition-all duration-300">
    <div class="flex items-center justify-between mb-2">
        <div class="flex items-center gap-3">
            <span class="font-bold text-white">{{ pub.auteur.get_full_name|default:pub.auteur.username }}</span>
            <span class="text-xs text-blue-300 font-semibold uppercase">{{ pub.promotion }}</span>
            <span class="text-xs text-gray-400">{{ pub.date_pub|date:'d/m/Y H:i' }}</span>
        </div>
        {% if pub.auteur == user %}
        <form method="POST" hx-post="{% url 'delete_publication' pub.pk %}" hx-target="#pub-{{ pub.pk }}" hx-swap="outerHTML" class="inline-block">
            {% csrf_token %}
            <button type="submit"
                class="text-red-500 hover:text-white hover:bg-red-600 font-bold text-xs px-3 py-1 rounded-lg border border-red-500 transition duration-150 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2"
                title="Supprimer">
                <svg xmlns="http://www.w3.org/2000/svg" class="inline h-4 w-4 mr-1 align-text-bottom" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                Supprimer
            </button>
        </form>
        {% endif %}
    </div>
    <div class="mb-2">
        <h3 class="text-xl font-bold text-blue-200 mb-1">{{ pub.titre }}</h3>
        <p class="text-white whitespace-pre-line">{{ pub.contenu }}</p>
    </div>
    {% if pub.fichier %}
    <div class="mb-2">
        <a href="{{ pub.fichier.url }}" target="_blank" class="text-blue-400 underline hover:text-blue-200 transition">Voir le fichier joint</a>
    </div>
    {% endif %}
    <div class="flex flex-wrap gap-2 mt-2">
        {% for tag in pub.tags|default:''|cut:',' %}
            {% if tag.strip %}<span class="bg-blue-700/30 text-blue-200 px-2 py-1 rounded text-xs font-semibold">#{{ tag }}</span>{% endif %}
        {% endfor %}
    </div>
</div>
